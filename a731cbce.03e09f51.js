(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{101:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return o})),n.d(t,"default",(function(){return d}));var a=n(3),r=n(7),c=(n(0),n(119)),s={id:"managekeys",title:"Manage Keys"},l={unversionedId:"tutorials/managekeys",id:"tutorials/managekeys",isDocsHomePage:!1,title:"Manage Keys",description:"Lumos also provides the functions to create private and public keys.",source:"@site/docs\\tutorials\\managekeys.md",slug:"/tutorials/managekeys",permalink:"/lumos_doc/docs/tutorials/managekeys",editUrl:"https://github.com/xying21/lumos_doc/tree/master/docs/tutorials/managekeys.md",version:"current",sidebar:"someSidebar",previous:{title:"Assemble Transactions",permalink:"/lumos_doc/docs/tutorials/buildtransactions"},next:{title:"DApps on CKB Workshop Code",permalink:"/lumos_doc/docs/tutorials/integratenft"}},o=[{value:"Prerequisites",id:"prerequisites",children:[]},{value:"Examples",id:"examples",children:[{value:"Create an Extended Private Key",id:"create-an-extended-private-key",children:[]},{value:"Generate a Public Key from the Private Key",id:"generate-a-public-key-from-the-private-key",children:[]},{value:"Generate Addresses from the Public Key",id:"generate-addresses-from-the-public-key",children:[]},{value:"Generate the Lock Script",id:"generate-the-lock-script",children:[]},{value:"Generate the Lock Hash",id:"generate-the-lock-hash",children:[]},{value:"Use the HD Cache Manager",id:"use-the-hd-cache-manager",children:[]}]}],i={toc:o};function d(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(c.b)("wrapper",Object(a.a)({},i,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"Lumos also provides the functions to create private and public keys."),Object(c.b)("p",null,"The following methods are described in this guide:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Create an Extended Private Key by Using the Lumos HD Wallet Manager. "),Object(c.b)("li",{parentName:"ul"},"Generate a Public Key from the Private Key."),Object(c.b)("li",{parentName:"ul"},"Generate Addresses from the Public Key.")),Object(c.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(c.b)("p",null,"The following prerequisites apply for managing accounts by using Lumos:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"The CKB node is running."),Object(c.b)("li",{parentName:"ul"},"The Lumos packages are installed.")),Object(c.b)("h2",{id:"examples"},"Examples"),Object(c.b)("h3",{id:"create-an-extended-private-key"},"Create an Extended Private Key"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript",metastring:'title="/mydapp/src/managekey.ts"',title:'"/mydapp/src/managekey.ts"'}),'import { mnemonic, ExtendedPrivateKey } from "@ckb-lumos/hd";\nconst m = mnemonic.generateMnemonic();\nconst seed = mnemonic.mnemonicToSeedSync(m);\nconst extendedPrivateKey = ExtendedPrivateKey.fromSeed(seed);\nconsole.log(extendedPrivateKey);\n')),Object(c.b)("details",null,Object(c.b)("summary",null,"CLICK ME"),Object(c.b)("p",null,Object(c.b)("h4",{id:""}),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"ExtendedPrivateKey {\n  privateKey: '0x0bd29e73cb36399a5e4071153ae927248c914a402a2de91e8eb609c5256a907f',\n  chainCode: '0x2a37938ba7904529f4ab19456feeae9aa4f0dae6b066b4e52d51f49684f8f392'\n}\n")))),Object(c.b)("h3",{id:"generate-a-public-key-from-the-private-key"},"Generate a Public Key from the Private Key"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript",metastring:'title="/mydapp/src/managekey.ts"',title:'"/mydapp/src/managekey.ts"'}),'const publickey = extendedPrivateKey.toExtendedPublicKey().publicKey;\nconsole.log("The public key is", publickey);\n')),Object(c.b)("details",null,Object(c.b)("summary",null,"CLICK ME"),Object(c.b)("p",null,Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"The public key is 0x028ce047ab13c66822d10801a9dfffb62b6059798f3d87abd33a5665bb4a7c0346\n")))),Object(c.b)("h3",{id:"generate-addresses-from-the-public-key"},"Generate Addresses from the Public Key"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript",metastring:'title="/mydapp/src/managekey.ts"',title:'"/mydapp/src/managekey.ts"'}),'import { env } from "process";\nimport {\n    AddressPrefix,\n    AddressType as Type,\n    pubkeyToAddress,\n  } from "@nervosnetwork/ckb-sdk-utils";\n\nimport { initializeConfig } from "@ckb-lumos/config-manager";\nenv.LUMOS_CONFIG_FILE = env.LUMOS_CONFIG_FILE || "./config.json";\ninitializeConfig();\n\nexport const publicKeyAddress = (\n  publicKey: string,\n ) => {\n  const pubkey = publicKey.startsWith("0x") ? publicKey : `0x${publicKey}`;  \n  const mainnetaddress = pubkeyToAddress(pubkey, {\n        prefix:AddressPrefix.Mainnet,\n        type: Type.HashIdx,\n        codeHashOrCodeHashIndex: "0x00",\n      });\n  const testnetaddress = pubkeyToAddress(pubkey, {\n        prefix:AddressPrefix.Testnet,\n        type: Type.HashIdx,\n        codeHashOrCodeHashIndex: "0x00",\n      });\n   return [mainnetaddress, testnetaddress];  \n  };\nconst mainnetaddress = publicKeyAddress(pubKey)[0];\nconst testnetaddress = publicKeyAddress(pubKey)[1];\nconsole.log("The mainnet address is", publicKeyAddress(pubKey)[0]);\nconsole.log("The testnet address is", publicKeyAddress(pubKey)[1]);\n')),Object(c.b)("details",null,Object(c.b)("summary",null,"CLICK ME"),Object(c.b)("p",null,Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"The mainnet address is ckb1qyq2rulujdgjn2r8dsl4xk500mj4qgs32rhqk8yxru\nThe testnet address is ckt1qyq2rulujdgjn2r8dsl4xk500mj4qgs32rhqtz6e0q\n")))),Object(c.b)("h3",{id:"generate-the-lock-script"},"Generate the Lock Script"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript",metastring:'title="/mydapp/src/managekey.ts"',title:'"/mydapp/src/managekey.ts"'}),'import { parseAddress } from "@ckb-lumos/helpers";\nconst lockScript = parseAddress(mainnetaddress);\nconsole.log("The lockScript is ", lockScript);\n')),Object(c.b)("details",null,Object(c.b)("summary",null,"CLICK ME"),Object(c.b)("p",null,Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"The lockScript is  {\n  code_hash: '0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8',\n  hash_type: 'type',\n  args: '0xa1f3fc935129a8676c3f535a8f7ee550221150ee'\n}\n")))),Object(c.b)("h3",{id:"generate-the-lock-hash"},"Generate the Lock Hash"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript",metastring:'title="/mydapp/src/managekey.ts"',title:'"/mydapp/src/managekey.ts"'}),'import { utils } from "@ckb-lumos/base";\nconst { computeScriptHash } = utils;\nconst lockHash = computeScriptHash(lockScript);\nconsole.log("The lockHash is", lockHash);\n')),Object(c.b)("details",null,Object(c.b)("summary",null,"CLICK ME"),Object(c.b)("p",null,Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-shell"}),"The lockHash is 0xee975e19f18318afb708d49567e6f9e652a0d58cd18043f4c85be2a81351a0ac\n")))),Object(c.b)("h3",{id:"use-the-hd-cache-manager"},"Use the HD Cache Manager"),Object(c.b)("pre",null,Object(c.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript",metastring:'title="/mydapp/src/managekey.ts"',title:'"/mydapp/src/managekey.ts"'}),'import { Indexer } from "@ckb-lumos/indexer";\nconst CKB_RPC = "http://127.0.0.1:8114";\nexport const INDEXER = new Indexer(CKB_RPC, "./indexed-data");\nimport { CacheManager,CellCollector, CellCollectorWithQueryOptions, getBalance } from "@ckb-lumos/hd-cache";\n\nexport const useHDCache = async (\n  keystorePath: string,\n  password: string\n) => {\n\n  const cacheManager = CacheManager.loadFromKeystore(INDEXER, keystorePath, password)\n  cacheManager.startForever();\n  const masterPubkey = cacheManager.getMasterPublicKeyInfo();\n  const nextReceivingPubkey = cacheManager.getNextReceivingPublicKeyInfo();\n  const nextChangePubkey = cacheManager.getNextChangePublicKeyInfo();\n  console.log("Get HD Wallet Balance");\n  const cellCollector = new CellCollector(cacheManager);\n  for await (const cell of cellCollector.collect()) {\n    cells.push(cell);\n    //console.log(cell)\n  }\n  const balance = await getBalance(cellCollector);\n  console.log("The HD wallet balance is", balance);\n}\n')))}d.isMDXComponent=!0},119:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=r.a.createContext({}),d=function(e){var t=r.a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},b=function(e){var t=d(e.components);return r.a.createElement(i.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,c=e.originalType,s=e.parentName,i=o(e,["components","mdxType","originalType","parentName"]),b=d(n),u=a,m=b["".concat(s,".").concat(u)]||b[u]||p[u]||c;return n?r.a.createElement(m,l(l({ref:t},i),{},{components:n})):r.a.createElement(m,l({ref:t},i))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var c=n.length,s=new Array(c);s[0]=u;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:a,s[1]=l;for(var i=2;i<c;i++)s[i]=n[i];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);