<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/lumos_doc/blog/rss.xml" title="Lumos Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/lumos_doc/blog/atom.xml" title="Lumos Blog Atom Feed"><title data-react-helmet="true">Getting Started | Lumos</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Getting Started | Lumos"><meta data-react-helmet="true" name="description" content="Prerequisites"><meta data-react-helmet="true" property="og:description" content="Prerequisites"><meta data-react-helmet="true" property="og:url" content="https://github.com/xying21/lumos_doc/lumos_doc/docs/quickstart/getstarted"><link data-react-helmet="true" rel="shortcut icon" href="/lumos_doc/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://github.com/xying21/lumos_doc/lumos_doc/docs/quickstart/getstarted"><link rel="stylesheet" href="/lumos_doc/styles.2d1157fe.css">
<link rel="preload" href="/lumos_doc/styles.82ab7796.js" as="script">
<link rel="preload" href="/lumos_doc/runtime~main.cc878a7a.js" as="script">
<link rel="preload" href="/lumos_doc/main.6a9ad168.js" as="script">
<link rel="preload" href="/lumos_doc/1.87e6500f.js" as="script">
<link rel="preload" href="/lumos_doc/34.717f5fd4.js" as="script">
<link rel="preload" href="/lumos_doc/35.0bd27fff.js" as="script">
<link rel="preload" href="/lumos_doc/f976f453.6d3e5d8a.js" as="script">
<link rel="preload" href="/lumos_doc/33.fd9d65ac.js" as="script">
<link rel="preload" href="/lumos_doc/03d2d3a5.3cfad674.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/lumos_doc/"><img src="/lumos_doc/img/favicon.png" alt="Lumos" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/lumos_doc/img/favicon.png" alt="Lumos" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Lumos Documentation</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/lumos_doc/docs/quickstart/intro">Docs</a><a href="https://nervosnetwork.github.io/lumos/globals.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Documenation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/nervosnetwork/lumos" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/lumos_doc/"><img src="/lumos_doc/img/favicon.png" alt="Lumos" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/lumos_doc/img/favicon.png" alt="Lumos" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Lumos Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/lumos_doc/docs/quickstart/intro">Docs</a></li><li class="menu__list-item"><a href="https://nervosnetwork.github.io/lumos/globals.html" target="_blank" rel="noopener noreferrer" class="menu__link">API Documenation</a></li><li class="menu__list-item"><a href="https://github.com/nervosnetwork/lumos" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Quickstart</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/lumos_doc/docs/quickstart/intro">Overview</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/lumos_doc/docs/quickstart/getstarted">Getting Started</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Lumos Components</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lumos_doc/docs/package/indexer">Lumos Indexer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lumos_doc/docs/package/commonscripts">Common Scripts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lumos_doc/docs/package/base">Base</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lumos_doc/docs/package/helpers">Helpers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lumos_doc/docs/package/configmanager">Configuration Manager</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lumos_doc/docs/package/hd">HD Wallet Manager</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lumos_doc/docs/package/hdcache">HD Cache Manager</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lumos_doc/docs/package/transactionmanager">Transaction Manager</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lumos_doc/docs/tutorials/acp">Anyone Can Pay</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lumos_doc/docs/tutorials/dao">Nervos DAO</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lumos_doc/docs/tutorials/nft">NFT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lumos_doc/docs/tutorials/sudt">SUDT</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Getting Started</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="prerequisites"></a>Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h2><p>The following prerequisites apply for using Lumos to develop CKB DApps:</p><ul><li>Basic Skills<ul><li>Nervos CKB. For more details about the basic knowledge of Nervos CKB, see <a href="https://docs.nervos.org/docs/basics/introduction" target="_blank" rel="noopener noreferrer">Nervos CKB Basics</a>.</li><li>Knowledge of CKB Data Model. For more details about the CKB data model, see <a href="https://docs.nervos.org/docs/reference/introduction" target="_blank" rel="noopener noreferrer">Nervos CKB Reference</a> and <a href="https://github.com/nervosnetwork/rfcs/blob/master/rfcs/0019-data-structures/0019-data-structures.md" target="_blank" rel="noopener noreferrer">CKB Data Structure</a>.</li><li>Lumos features</li></ul></li><li>Development Stacks<ul><li>JavaScript runtime environment: NodeJS version 12+</li><li>Web application framework: Express.js is recommended.</li><li>OS:  MacOS, Ubuntu Linux, or Windows 10 + WSL2 (Ubuntu)</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="workflow"></a>Workflow<a class="hash-link" href="#workflow" title="Direct link to heading">#</a></h2><p>The basic steps for developing a CKB DApp are as follows:</p><ol><li>Prepare the prerequisite skills and development stacks listed in <a href="/lumos_doc/docs/quickstart/getstarted#prerequisites">Prerequisites</a></li><li>Install and configure Nervos CKB</li><li>Create the node skeleton</li><li>Set up the config manager</li><li>Program common CKB tasks</li><li>Troubleshooting</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="steps"></a>Steps<a class="hash-link" href="#steps" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="install-and-configure-nervos-ckb"></a>Install and Configure Nervos CKB<a class="hash-link" href="#install-and-configure-nervos-ckb" title="Direct link to heading">#</a></h3><p>If Nervos CKB is already installed, perform step 6 to start the CKB Node directly.</p><p>To install and configure Nervos CKB:</p><p><strong>Step 1. Download the latest CKB binary file from the CKB releases page on <a href="https://github.com/nervosnetwork/ckb/releases" target="_blank" rel="noopener noreferrer">GitHub</a>.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ export TOP=$(pwd)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># I&#x27;m testing this on a Linux machine, if you use other platforms, please adjust</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># this accordingly.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ curl -LO https://github.com/nervosnetwork/ckb/releases/download/v0.33.0/ckb_v0.33.0_x86_64-unknown-linux-gnu.tar.gz</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ tar xzf ckb_v0.33.0_x86_64-unknown-linux-gnu.tar.gz</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ export PATH=$PATH:$TOP/ckb_v0.33.0_x86_64-unknown-linux-gnu</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 2. Verify the binaries are working and check versions.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ ckb -V</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ckb 0.33.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ ckb init -C devnet -c dev</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 3. Modify the chain config to skip difficulty adjustment, and set all epoch to contain 10 blocks.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ ed devnet/specs/dev.toml &lt;&lt;EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">91d</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">90a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">genesis_epoch_length = 10</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">permanent_difficulty_in_dummy = true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">wq</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 4. Modify miner config to generate a new block every second.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ ed devnet/ckb-miner.toml &lt;&lt;EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">39s/5000/1000/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">wq</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 5. Use a specific private key as the wallet used in miner.</strong> </p><p><strong>Note</strong>: Do not use this private key in other place.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ ed devnet/ckb.toml &lt;&lt;EOF</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">143a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[block_assembler]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">code_hash = &quot;0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># private key: 0x29159d8bb4b27704b168fc7fae70ffebf82164ce432b3f6b4c904a116a969f19</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">args = &quot;0xcbfbb9edb5838e2d61061c3fc69eaaa5fdbd3273&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">hash_type = &quot;type&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">message = &quot;0x&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">wq</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">EOF</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 6. Start the CKB node with the dev chain.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ ckb run -C devnet</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 7. Start the CKB miner in a different terminal.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ export TOP=$(pwd)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ export PATH=$PATH:$TOP/ckb_v0.33.0_x86_64-unknown-linux-gnu</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ ckb miner -C devnet</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="create-the-node-skeleton"></a>Create the Node Skeleton<a class="hash-link" href="#create-the-node-skeleton" title="Direct link to heading">#</a></h3><p>The node skeleton is used to run the JavaScript code.</p><p>To create the node skeleton:</p><p><strong>Step 1. Create a new directory for the skeleton and navigate into it.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ mkdir mydapp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ cd mydapp</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 2. Add Lumos packages as dependencies for the project.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ yarn init</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ yarn add @ckb-lumos/indexer@0.14.1 @ckb-lumos/common-scripts@0.14.1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 3. Install all dependencies.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ yarn install</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 4. Enable async/await for the node shell:</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ node --experimental-repl-await</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Welcome to Node.js v12.16.2.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Type &quot;.help&quot; for more information.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="set-up-the-config-manager"></a>Set Up the Config Manager<a class="hash-link" href="#set-up-the-config-manager" title="Direct link to heading">#</a></h3><p>To set up the config manager:</p><p><strong>Note</strong>: The following example shows how to set up the config manager by using pre_defined configurations. The config manager can also be set up by using a local config file. For more information about config manager, see the <a href="/lumos_doc/docs/package/configmanager">Config Manager</a> section.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ LUMOS_CONFIG_NAME=LINA node --experimental-repl-await</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Welcome to Node.js v12.16.2.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Type &quot;.help&quot; for more information.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const { initializeConfig } = require(&quot;@ckb-lumos/config-manager&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; initializeConfig();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="start-the-lumos-indexer"></a>Start the Lumos Indexer<a class="hash-link" href="#start-the-lumos-indexer" title="Direct link to heading">#</a></h3><p>The DApp that is built with Lumos must have an indexer configured and running.</p><p>To start the Lumos indexer:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const { Indexer } = require(&quot;@ckb-lumos/indexer&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; const indexer = new Indexer(&quot;http://127.0.0.1:8114&quot;, &quot;./indexed-data&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">&gt; indexer.startForever();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="program-common-ckb-tasks"></a>Program Common CKB Tasks<a class="hash-link" href="#program-common-ckb-tasks" title="Direct link to heading">#</a></h3><p>The DApps built with Lumos mainly deal with user queries and transaction requests, such as transferring capacity, deposits, withdrawals, and other operations of user assets.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="query-flow"></a>Query Flow<a class="hash-link" href="#query-flow" title="Direct link to heading">#</a></h4><ol><li>The DApp uses the index database of cells to find all the live cells satisfying the query conditions.</li><li>The DApp perform other related operations or calculations and returns the result to the user.</li></ol><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example-get-the-balance-of-an-account"></a>Example: Get the Balance of an Account<a class="hash-link" href="#example-get-the-balance-of-an-account" title="Direct link to heading">#</a></h5><p><strong>Step 1. Find all the simple CKB cells for the user.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> script </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  code_hash</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  hash_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;type&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0xcbfbb9edb5838e2d61061c3fc69eaaa5fdbd3273&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> collector </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> indexer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">collector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> lock</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> script</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword null nil" style="font-style:italic">null</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> cells</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Cell</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> cell </span><span class="token keyword" style="font-style:italic">of</span><span class="token plain"> collector</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">collect</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  cells</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">push</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cell</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 2. Add the capacity of these cells up and return the result as the balance.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> balance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">BigInt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> cells</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">cell</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">BigInt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      cell</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">cell_output</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">capacity</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">reduce</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">balance</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> capacity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">balance </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> balance </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> capacity</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="transaction-flow"></a>Transaction Flow<a class="hash-link" href="#transaction-flow" title="Direct link to heading">#</a></h4><ol><li><p>Build a transaction skeleton.</p></li><li><p>Add a fee for the transaction. <strong>Note</strong>: It is also possible to have someone other than the sender to pay the fee. </p></li><li><p>Prepare the signing entries: The signing entries are the data that the user&#x27;s wallet needs to sign to provide valid witnesses for the input lock scripts. </p></li><li><p>Send the raw transaction to the client:  From the security perspective of a DApp, Lumos does not support built-in message signing. So the DApp needs to send the raw transaction  to the user wallet to acquire signatures. The raw transaction contains all the cells and dependencies for the action and the data that needs to be signed. </p><p>After the client gets the skeleton, the client forwards the transaction skeleton to the wallet for signing. </p></li><li><p>Seal the transaction: The transaction with signatures is forwarded to the DApp. The DApp seals the transaction by adding the transaction signatures to the transaction structure. </p></li><li><p>Send this finalized transaction to the CKB network: The sealed transaction is then forwarded to the CKB network.</p><p>Upon successful receipt, the CKB network returns the transaction hash to the DApp. The transaction hash is sent back to the client such that the client can track the transactions.</p></li><li><p>(Optional) Get the Transaction Status: A transaction can be in one of the three statuses: <strong>pending</strong>, <strong>proposed</strong> and <strong>committed</strong>.</p><p>A <strong>pending</strong> result means the node is aware of the transaction but the transaction is not confirmed yet. </p><p>A <strong>proposed</strong> result means the node sees a transaction included in a block candidate that is not yet mined. </p><p>A <strong>committed</strong> result means that the block involving the transaction has been mined and is officially on chain.</p></li></ol><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example-transfer-ckb-from-the-current-live-cells"></a>Example: Transfer CKB from the Current Live Cells<a class="hash-link" href="#example-transfer-ckb-from-the-current-live-cells" title="Direct link to heading">#</a></h5><p>To transfer CKB from the current set of live cells in response to a user request:</p><p><strong>Step 1. Create a transaction skeleton.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">sealTransaction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token maybe-class-name">TransactionSkeleton</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;@ckb-lumos/helpers&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword module" style="font-style:italic">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> common </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token keyword module" style="font-style:italic">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;@ckb-lumos/common-scripts&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> tipHeader </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  compact_target</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x20010000&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  dao</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x49bfb20771031d556c8480d47f2a290059f0ac7e383b6509006f4a772ed50200&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  epoch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0xa0006002b18&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  hash</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x432451e23c26f45eaceeedcc261764d6485ea5c9a204ac55ad755bb8dec9a079&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  nonce</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x8199548f8a5ac7a0f0caef1620f37b79&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  number</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x1aef6&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  parent_hash</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x63594a64108f19f6aed53d0dca9ab4075aac4379cb80b2097b0deac8fc16fd3b&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  proposals_hash</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x0000000000000000000000000000000000000000000000000000000000000000&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  timestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x172f6b9a4cf&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  transactions_root</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x282dbadcd49f3e229d997875f37f4e4f19cb4f04fcf762e9639145aaa667b6f8&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  uncles_hash</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x0000000000000000000000000000000000000000000000000000000000000000&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  version</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x0&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> senderaddress </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">generateAddress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">script</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> recipient </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ckt1qyqx57xrsztnq7g5mlw6r998uyc2f5hm3vnsvgsaet&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> amount </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100153459536n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> txFee </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">  </span><span class="token number" style="color:rgb(247, 140, 108)">100000000n</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> txSkeleton </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(130, 170, 255)">TransactionSkeleton</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    cellProvider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> indexer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">txSkeleton </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> common</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">transfer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  txSkeleton</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  senderaddress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  recipient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">BigInt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tipHeader</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 2. Add a fee for the transaction.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  txSkeleton </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> common</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">payFee</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    txSkeleton</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    senderaddress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">BigInt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">txFee</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    tipHeader</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 3. Prepare the signing entries.</strong> </p><p>To prepare the signing entries:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> txSkeleton </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> common</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">prepareSigningEntries</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">txSkeleton</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 4. Sign the transaction.</strong></p><p>For demonstration purpose, this example uses a secp256k1 tool to generate a signature based on the private key <code>0x29159d8bb4b27704b168fc7fae70ffebf82164ce432b3f6b4c904a116a969f19</code>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">const signatures = [&quot;0x1cb952fd224d1d14d07af621587e91a65ccb051d55ed1371b3b66d4fe169cf7758173882e4c02587cb54054d2de287cbb1fdc2fc21d848d7b320ee8c5826479901&quot;];</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 5. Seal the transaction with the signatures.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> tx </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sealTransaction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">txSkeleton</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> signatures</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 6. Send this finalized transaction to the CKB network.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">RPC</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ckb-js-toolkit&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> rpc </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">RPC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;http://127.0.0.1:8114&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> rpc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">send_transaction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;0x88536e8c25f5f8c89866dec6a5a1a6a72cccbe282963e4a7bfb5542b4c15d376&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><strong>Step 7. (Optional) Get the Transaction Status.</strong></p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-javascript codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> tx </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">await</span><span class="token plain"> rpc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">get_transaction</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">txHash</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> tx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">tx_status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/xying21/lumos_doc/tree/master/docs/quickstart/getstarted.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/lumos_doc/docs/quickstart/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/lumos_doc/docs/package/indexer"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lumos Indexer Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link">Prerequisites</a></li><li><a href="#workflow" class="table-of-contents__link">Workflow</a></li><li><a href="#steps" class="table-of-contents__link">Steps</a><ul><li><a href="#install-and-configure-nervos-ckb" class="table-of-contents__link">Install and Configure Nervos CKB</a></li><li><a href="#create-the-node-skeleton" class="table-of-contents__link">Create the Node Skeleton</a></li><li><a href="#set-up-the-config-manager" class="table-of-contents__link">Set Up the Config Manager</a></li><li><a href="#start-the-lumos-indexer" class="table-of-contents__link">Start the Lumos Indexer</a></li><li><a href="#program-common-ckb-tasks" class="table-of-contents__link">Program Common CKB Tasks</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Nervos</div></div></div></footer></div>
<script src="/lumos_doc/styles.82ab7796.js"></script>
<script src="/lumos_doc/runtime~main.cc878a7a.js"></script>
<script src="/lumos_doc/main.6a9ad168.js"></script>
<script src="/lumos_doc/1.87e6500f.js"></script>
<script src="/lumos_doc/34.717f5fd4.js"></script>
<script src="/lumos_doc/35.0bd27fff.js"></script>
<script src="/lumos_doc/f976f453.6d3e5d8a.js"></script>
<script src="/lumos_doc/33.fd9d65ac.js"></script>
<script src="/lumos_doc/03d2d3a5.3cfad674.js"></script>
</body>
</html>